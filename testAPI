#!/bin/bash

INPUT_DIR="./INPUT"
OUTPUT_DIR="./OUTPUT"
SPLIT_SIZE="100M"

mkdir -p "$OUTPUT_DIR"

for filepath in "$INPUT_DIR"/*; do
  [ -f "$filepath" ] || continue

  filename=$(basename "$filepath")
  base="${filename%.*}"

  echo "‚û°Ô∏è  Archivage et split de $filename..."

  archive_path="$OUTPUT_DIR/${base}.tar.gz"
  tar -czf "$archive_path" -C "$INPUT_DIR" "$filename"

  split_prefix="$OUTPUT_DIR/${base}_partie_"
  split -b "$SPLIT_SIZE" "$archive_path" "$split_prefix"

  echo "‚úÖ Termin√© pour $filename"
  echo "-----------------------------------"
done




#!/bin/bash

OUTPUT_DIR="./OUTPUT"
TMP_DIR="./TMP_RECONSTRUCT"

mkdir -p "$TMP_DIR"

# Trouver tous les pr√©fixes des fichiers d√©coup√©s
cd "$OUTPUT_DIR" || exit 1
for prefix in $(ls *_partie_* | sed 's/_partie_.*//' | sort -u); do
  echo "‚û°Ô∏è  Reconstitution de $prefix..."

  cat ${prefix}_partie_* > "$TMP_DIR/${prefix}_reconstruit.tar.gz"

  extract_dir="$TMP_DIR/${prefix}_extract"
  mkdir -p "$extract_dir"

  if tar -xzf "$TMP_DIR/${prefix}_reconstruit.tar.gz" -C "$extract_dir"; then
    echo "‚úÖ Extraction OK pour $prefix"
    echo "üßπ Nettoyage..."
    rm -f "${prefix}.tar.gz"
    rm -f "${prefix}_partie_"*
    rm -f "$TMP_DIR/${prefix}_reconstruit.tar.gz"
    rm -rf "$extract_dir"
    echo "‚úÖ Nettoyage termin√© pour $prefix"
  else
    echo "‚ùå √âchec de l'extraction pour $prefix"
  fi

  echo "-----------------------------------"
done


