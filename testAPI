# ✅ Test de Non-Régression Technique — `toto`

Ce projet exécute un **test de non-régression technique** (*TNR*) pour comparer deux versions de livrables techniques — typiquement des fichiers **XML**, **CSV**, **LOG** — de façon simple et traçable.

---

## 🎯 **Objectif**

- Vérifier automatiquement :
  - L’existence des fichiers dans les deux versions
  - La cohérence des tailles de fichiers
  - Le contenu **texte trié** ligne par ligne (pour neutraliser l’ordre)
- Fournir :  
  - Un **rapport `.txt`** détaillé et structuré
  - Des comparaisons visuelles **WinMerge**
  - Un diff **texte brut** via `fc` (ou `difflib` Python en secours)

---

## 📂 **Structure recommandée**


projet/
├── scripts/
│ └── toto.py # Ton script principal
├── utils/
│ └── WinMergeU.exe # Version portable de WinMerge
├── INPUT/
│ ├── Resultats_95_V1/ # Exemple Version 1
│ └── Resultats_95_V2/ # Exemple Version 2
├── TNR_RESULTS/ # Rapport généré + fichiers triés
└── README.md # Ce fichier


---

## ⚙️ **Prérequis**

- Python 3.x installé.
- `WinMergeU.exe` (version portable) placé dans `utils/`.
- Pour `fc` :
  - Disponible nativement sous **Windows** (`fc.exe`).
- Pas besoin d’autre module externe (tout est Python standard).

---

## ✅ **Fonctionnement**

1️⃣ Le script trie chaque fichier cible ligne par ligne pour neutraliser l’ordre (utile pour CSV/LOG/XML si l’ordre n’est pas significatif).  
2️⃣ Il compare chaque paire (`v1` ↔ `v2`) :
   - **Visuellement** avec **WinMerge** (ouvre la fenêtre GUI).
   - **Automatiquement** en ligne de commande avec `fc` :
     - Diff brute intégrée dans le rapport `.txt`.
     - Si `fc` n’est pas dispo, `difflib` Python prend le relais.
3️⃣ Il génère :
   - Un rapport texte `TNR_RESULTS/report_global.txt` détaillant tout.
   - Des copies triées dans `TNR_RESULTS/SORTED_FILES`.

---

## 🗂️ **Extensions traitées**

Par défaut :

.xml, .csv, .log


Ces extensions sont comparées **sans sensibilité à la casse**.

---

## 🚀 **Lancer le test**

Dans ton terminal (PowerShell ou `cmd.exe`) :

```bash
python scripts/toto.py --version1 "INPUT/Resultats_95_V1" --version2 "INPUT/Resultats_95_V2"



Crée un run_tnr.bat :

@echo off
echo Lancement du TNR...
python scripts\toto.py --version1 "INPUT/Resultats_95_V1" --version2 "INPUT/Resultats_95_V2"
pause





Objet : Données manquantes – Vérification et actions à venir

Bonjour,

Je fais suite au mail de DDD (ci-dessous). J’ai essayé de reproduire ces écarts de notre côté pour les sections concernées. Après vérification des fichiers XML, j’ai constaté que ces données sont absentes dans les deux versions V1 et V2. J’ai également vérifié les données d’entrée dans le dossier « INPUT/ » : ces informations n’y figurent pas non plus. C’est, selon moi, la raison pour laquelle elles n’apparaissent pas dans les résultats des versions V1 et V2.

J’en conclus que nous ne disposons probablement pas de la dernière mise à jour des données d’entrée pour le lot 34.

Actions :

Récupérer les nouvelles données du lot 34 afin de pouvoir reproduire ces écarts de notre côté.

Bien cordialement,
[Votre Nom]




Bonjour,

Suite à votre retour concernant les lignes manquantes, nous avons mené plusieurs vérifications pour comprendre l’origine de ces écarts.

Dans un premier temps, nous avons tenté de reproduire ces écarts de notre côté sur les sections concernées. Nous avons ensuite vérifié le contenu des fichiers XML générés pour les versions V1 et V2 : nous avons constaté que les données signalées comme manquantes n’y figurent pas et qu’il n’y a pas d’écart entre les fichiers produits pour V1 et V2.

Nous avons également contrôlé les fichiers d’entrée disponibles dans le dossier « INPUT/ » : là encore, les informations manquantes ne sont pas présentes. Cela confirme que ces données n’ont pas été intégrées lors du traitement, faute de disponibilité en entrée.

Nous en concluons donc que nous ne disposons probablement pas de la dernière mise à jour des données d’entrée pour le lot 34.

Prochaine étape :
Afin de pouvoir poursuivre notre analyse et résoudre ces écarts, nous vous proposons de nous transmettre la version la plus récente des données du lot 34. Dès réception, nous relancerons les traitements et reviendrons vers vous avec les résultats mis à jour.

Nous restons à votre disposition pour toute précision complémentaire.

Bien cordialement,
